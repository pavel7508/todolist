<?php
?>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>List of tasks</title>

	<link rel="stylesheet" href='{{ url_for("static" ,filename="style.css") }}'>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <!-- jQuery library -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

	<!-- Popper JS -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	
	<!-- Latest compiled JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<style>
	body {	
		background-color: rgb(28, 26, 41);
		}
	.container{
			background-color: lightslategrey;		
			border-radius: 15px;
	}
	.login-form{
		color: aliceblue;
		text-align: center;
		margin-top: 200px;
	}
	h2{
		color: aliceblue;
		text-align: center;
		margin-top:15px;
	}
	</style>
</head>
<body>

	{% if not success %}
	<div class="menu">
		<ul class="menu-item">
			<li><a href="/">Home</a></li>
			<li><a href="/login">Login</a></li>
			<li><a href="/register">Register</a></li>
			<li><a href="/about">About</a></li>
			<li><a href="/contact">Contact</a></li>
		</ul>
	</div>
	<div class="clearfix">
	 <h2>Welcome in ToDo app</h2>
    </div>
	<div class="login-form">	
		<h5>Please login or register </h5>
		
		{% with messages=get_flashed_messages() %}
			{% if messages %}
				{% for message in messages  %}
					<h6>{{ message }}</h6>
				{% endfor %}
			{% endif %}
		{% endwith %}
		
	</div>
		
		

	{% endif %}

	{% if success %}
	<div class="menu">
		<ul class="menu-item">
			<li><a href="/">Home</a></li>
			<li><a href="/about">About</a></li>
			<li><a href="/contact">Contact</a></li>
			{% if user %}
				<li class="session">{{ user }}</li>
				<li class="session" ><a href="/logout">Logout</a></li>
			{% endif %}
		</ul>
	</div>
	{% with messages=get_flashed_messages() %}
			{% if messages %}
				{% for messages in messages  %}
					{{ message }}
				{% endfor %}
			{% endif %}
		{% endwith %}
	
	<div class="container"style="margin-top:20px" >
		<div style="height: 20px"></div>
		<p><h1 class="text-center " style="text-decoration: underline;color:white">List of Tasks</h1></p>
		<div style="height: 10px"></div>
		<form action="/todolist">
			
			<div class="form-row">
				<a href="/add"class="btn btn-success col-1" name="add">Add</a>
				<a href="" onclick="print()" class="btn btn-light col-1 offset-10 " name="Print">Print</a>
			</div>
				
		
		<hr>
		<div id=menu>
		 	<div id="item" class="btn btn-warning">Filter</div>
			<div id="submenu">
			    <input type="submit" name="submit" value="Savedate" class="col-sm-1 btn btn-primary">					
				<input type="submit" name="submit" value="History" class="col-sm-1  btn btn-danger">
				<input type="submit" name="submit" value="All" class="col-sm-1  btn btn-success">
			</div>
				
		</div>
		</form>
		<div class="row" >
			<!--<div class="col-sm-1">#</div>-->
			<div class="col-md-1">Done:</div>
			<div class="col-md-7">Task:</div>
			<div class="col-md-2 ">Deadline:</div>
			
		</div>
		<hr>
		
		<form action="" >
			{% for record in records %}
			<div class="input-group datum2">
				
				<!--<input type="text" readonly="readonly" value="{{ record[0] }}" name="id" class=" form-control col-sm-1">-->
				{% if record[3]==1 %}
				
  					<input type="radio" value=1 disabled checked id="checkbox"  class=" form-control col-md-1  ifchecked">
			
  				{% else %}
					
  					<input type="radio" value=0 disabled id="checkbox" class=" form-control col-md-1 ifchecked">
			    
  				{% endif %}
  				<input type="text" readonly="readonly" class="form-control col-xl-7" name="ukol" id="ukol" value="{{ record[1] }}" >

  				<input type="text" readonly="readonly" class="form-control-date col-md-2 datum3"  name="execdate"  value="{{ record[2] }}">
  				
				<a href="/edit?id={{record[0]}}"  class=" col-md-1 btn btn-success" name="edit">Edit</a>

  				<a href="/del?id={{ record[0] }}"  class="col-md-1 btn btn-danger" name="delete" >Delete</a>

  				
  			</div>
  			<br>
  			{% endfor %}
  			
		</form>
		{% endif %}
		<div id="datum"></div>
	</div>
	
	<script>
	function checkdate(odstavec,ifchecked){
		datum1=new Date(odstavec.value);
		hodnota=ifchecked.value;
		console.log(datum1)
		var datum= new Date();
		var sec=datum.getTime();
		
		if ((datum1.getTime() < sec)&&(hodnota==0)){
			odstavec.style.backgroundColor="red";
		}
	};
	var a=document.getElementsByClassName("datum3");
	var b=document.getElementsByClassName("ifchecked");
	for (i=0;i<a.length;i++){
		checkdate(a[i],b[i]);
		console.log(b[i]);
	}
	
	$("#submenu").hide();
	$("#item").click(function(){
		$("#submenu").slideToggle({width:'200px'},500);
	
	});
	</script>
	
</body>
</html>